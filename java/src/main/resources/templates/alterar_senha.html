<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{shared/layout :: head}"></head>
<body style="background-color: #f8f9fa; min-height: 100vh;">

<div class="container d-flex justify-content-center align-items-center vh-100">
    <div class="card shadow-sm p-5 rounded-4" style="width: 100%; max-width: 420px; background-color: #fff;">
        <h2 class="text-center mb-5 fw-bold text-dark">Redefinir Senha</h2>
        <form th:action="@{/alterar-senha}" method="post" onsubmit="return validarSenha()" novalidate>
            <div class="mb-4">
                <label for="senhaNova" class="form-label fw-semibold text-secondary">Nova Senha</label>
                <input type="password" class="form-control form-control-lg" id="senhaNova" name="novaSenha" placeholder="Digite a nova senha" required minlength="6" autocomplete="new-password">
            </div>
            <div class="mb-5">
                <label for="confirmarSenha" class="form-label fw-semibold text-secondary">Confirmar Nova Senha</label>
                <input type="password" class="form-control form-control-lg" id="confirmarSenha" name="confirmarSenha" placeholder="Confirme a nova senha" required minlength="6" autocomplete="new-password">
            </div>
            <div class="d-grid">
                <button class="btn btn-success btn-lg fw-semibold" type="submit" style="letter-spacing: 0.05em;">Salvar Nova Senha</button>
            </div>
        </form>
    </div>
</div>

<div th:if="${mensagem}" th:with="msg=${mensagem}, tipo=${tipoMensagem}">
    <script th:inline="javascript">
        /*<![CDATA[*/
        let mensagem = /*[[${msg}]]*/ '';
        let tipo = /*[[${tipo}]]*/ '';

        if (mensagem && tipo) {
          if (tipo === 'sucesso') {
            Swal.fire({
              icon: 'success',
              title: 'Sucesso!',
              text: mensagem,
              confirmButtonColor: '#198754'
            });
          } else if (tipo === 'erro') {
            Swal.fire({
              icon: 'error',
              title: 'Erro!',
              text: mensagem,
              confirmButtonColor: '#dc3545'
            });
          }
        }
        /*]]>*/
    </script>
</div>

<script th:inline="javascript">
    function validarSenha() {
        const nova = document.getElementById('senhaNova').value;
        const confirmar = document.getElementById('confirmarSenha').value;

        if (nova !== confirmar) {
            Swal.fire({
                icon: 'error',
                title: 'Erro',
                text: 'As senhas não coincidem!'
            });
            return false;
        }
        if (nova.length < 6) {
            Swal.fire({
                icon: 'error',
                title: 'Erro',
                text: 'A senha deve ter no mínimo 6 caracteres!'
            });
            return false;
        }
        return true;
    }
</script>

</body>
</html>
